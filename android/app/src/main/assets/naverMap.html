<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://oapi.map.naver.com/openapi/v3/maps.js?ncpKeyId=f5ufkzerej"></script>
    <style>
        html, body, #map {
            height: 100%;
            margin: 0;
            padding: 0;
        }
    </style>
</head>
<body>
<div id="map"></div>

<script>
    const map = new naver.maps.Map('map', {
        center: new naver.maps.LatLng(36.5, 127.8),
        zoom: 7
    });

    function handleGeoJsonMessage(eventData) {
        try {
            const geoJsonData = JSON.parse(eventData);

            if (geoJsonData && geoJsonData.features) {

                const dataLayer = map.data;
                dataLayer.addGeoJson(geoJsonData);

                // GeoJSONì˜ ìŠ¤íƒ€ì¼ì„ ì„¤ì •
                dataLayer.setStyle(function (feature) {
                    const colorMap = {
                        'ê²½ê¸°ë„': '#ff9999',
                        'ê°•ì›ë„': '#99ccff',
                        'ì¶©ì²­ë¶ë„': '#ccffcc',
                        'ì¶©ì²­ë‚¨ë„': '#ffcc99',
                        'ê²½ìƒë¶ë„': '#ccccff',
                        'ê²½ìƒë‚¨ë„': '#ffccff',
                        'ì „ë¼ë¶ë„': '#ffff99',
                        'ì „ë¼ë‚¨ë„': '#99ff99',
                        'ì œì£¼íŠ¹ë³„ìì¹˜ë„': '#ff9966'
                    };
                    return {
                        fillColor: colorMap[feature.getProperty('CTP_KOR_NM')] || '#cccccc',
                        strokeColor: '#333',
                        strokeWeight: 2
                    };
                });

                // í´ë¦­ ì‹œ í•´ë‹¹ ì§€ì—­ë§Œ ë³´ì´ê²Œ í•˜ê³  ìƒ‰ìƒ ì œê±°
                dataLayer.addListener('click', function (e) {
                    const bounds = e.feature.getBounds();
                    const name = e.feature.getProperty('CTP_KOR_NM');

                    // ê³ ì • ì¤Œ ë ˆë²¨
                    const fixedZoomLevels = {
                        'ì „ë¼ë¶ë„': 9,
                        'ì¶©ì²­ë‚¨ë„': 9,
                        'ê²½ê¸°ë„': 9,
                        'ì„œìš¸íŠ¹ë³„ì‹œ': 10,
                        'ì¸ì²œê´‘ì—­ì‹œ': 10,
                        'ê°•ì›ë„': 9,
                        'ì¶©ì²­ë¶ë„': 9,
                        'ê²½ìƒë¶ë„': 9,
                        'ëŒ€êµ¬ê´‘ì—­ì‹œ': 10,
                        'ìš¸ì‚°ê´‘ì—­ì‹œ': 10,
                        'ë¶€ì‚°ê´‘ì—­ì‹œ': 10,
                        'ê²½ìƒë‚¨ë„': 9,
                        'ì „ë¼ë‚¨ë„': 9,
                        'ì œì£¼íŠ¹ë³„ìì¹˜ë„': 9,
                        'ëŒ€ì „ê´‘ì—­ì‹œ': 10,
                        'ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ': 10,
                        'ê´‘ì£¼ê´‘ì—­ì‹œ': 10
                    };
                    const fixedZoom = fixedZoomLevels[name] || 9;

                    const incheonCenter = new naver.maps.LatLng(37.4563, 126.7052);

                    if (name === 'ì¸ì²œê´‘ì—­ì‹œ') {
                        map.setCenter(incheonCenter);
                        map.setZoom(fixedZoom);
                    } else if (bounds) {
                        map.fitBounds(bounds);
                        map.setZoom(fixedZoom);
                    }
                    window.ReactNativeWebView?.postMessage(`ğŸ“ ì„ íƒí•œ ë„: ${name}`);

                    // ëª¨ë“  ì§€ì—­ì˜ ìƒ‰ìƒ ì´ˆê¸°í™”
                    dataLayer.setStyle(function (feature) {
                        return {
                            fillColor: '#cccccc', // ìƒ‰ìƒ ì´ˆê¸°í™” (íšŒìƒ‰)
                            fillOpacity: 0.5,
                            strokeColor: '#333',
                            strokeWeight: 2
                        };
                    });

                    // í´ë¦­í•œ ì§€ì—­ë§Œ ê°•ì¡° (ë°°ê²½ìƒ‰ ì œê±°)
                    dataLayer.setStyle(function (feature) {
                        const currentName = feature.getProperty('CTP_KOR_NM');
                        if (currentName === name) {
                            return {
                                fillColor: null, // í´ë¦­í•œ ì§€ì—­ ë°°ê²½ìƒ‰ ì œê±°
                                fillOpacity: 0,
                                strokeColor: '#333',
                                strokeWeight: 3
                            };
                        } else {
                            return {
                                fillColor: '#cccccc', // ë‹¤ë¥¸ ì§€ì—­ì€ ê¸°ë³¸ ìƒ‰ìƒ
                                fillOpacity: 0.7,
                                strokeColor: '#333',
                                strokeWeight: 2
                            };
                        }
                    });
                });

            } else {
                window.ReactNativeWebView?.postMessage("âŒ GeoJSON ë°ì´í„° ì—†ìŒ");
            }
        } catch (e) {
            window.ReactNativeWebView?.postMessage("âŒ GeoJSON ë°ì´í„° íŒŒì‹± ì˜¤ë¥˜: " + e.message);
        }
    }

    document.addEventListener("message", function (event) {
        handleGeoJsonMessage(event.data);
    });
</script>

</body>
</html>
